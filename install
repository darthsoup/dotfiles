#!/bin/bash

ask_for_sudo() {
	sudo -v

	while true; do
		sudo -n true
		sleep 60
		kill -0 "$$" || exit
	done &> /dev/null &
}

main() {
	# install dotfiles

	echo ' install dotfiles'

	# ask for Sudo

	ask_for_sudo;

	# quick copy pasta

	rsync -r \
		--exclude '.git' \
		--exclude 'LICENSE.md' \
		--exclude 'README.md' \
		--exclude 'install' ./ $HOME

	echo ' install minpac for vim'

	[[ -d ~/.vim/pack/minpac/opt/minpac ]] ||
		git clone --depth 1 -- \
			https://github.com/k-takata/minpac.git ~/.vim/pack/minpac/opt/minpac

	echo ' all done'
	echo ' restart the shell'
}

main "$@"
